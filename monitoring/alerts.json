{
    "monitoring_config": {
        "data_quality_thresholds": {
            "completeness": 95.0,
            "accuracy": 98.0,
            "timeliness": 99.0,
            "consistency": 97.0
        },
        "performance_thresholds": {
            "pipeline_execution_time_minutes": 30,
            "databricks_job_duration_minutes": 20,
            "data_ingestion_rate_mbps": 100,
            "api_response_time_seconds": 5
        },
        "error_thresholds": {
            "max_consecutive_failures": 3,
            "max_error_rate_percentage": 5.0,
            "max_retry_attempts": 3
        }
    },
    "alerts": [
        {
            "name": "Pipeline_Execution_Failure",
            "description": "Alert when the main customer data pipeline fails",
            "severity": "Critical",
            "conditions": {
                "pipeline_status": "Failed",
                "consecutive_failures": ">= 1"
            },
            "notification_channels": [
                {
                    "type": "email",
                    "recipients": ["data-engineering-team@bank.com", "oncall@bank.com"],
                    "subject": "CRITICAL: Customer Data Pipeline Failure",
                    "template": "pipeline_failure_email.html"
                },
                {
                    "type": "teams_webhook",
                    "webhook_url": "https://bank.webhook.office.com/webhookb2/...",
                    "channel": "#data-alerts",
                    "message_template": "🚨 **Pipeline Failure Alert**\n\nPipeline: {{pipeline_name}}\nExecution ID: {{execution_id}}\nError: {{error_message}}\nTimestamp: {{timestamp}}"
                },
                {
                    "type": "slack_webhook",
                    "webhook_url": "https://hooks.slack.com/services/...",
                    "channel": "#data-pipeline-alerts",
                    "message_template": "🚨 *CRITICAL: Pipeline Failure*\n• Pipeline: {{pipeline_name}}\n• Error: {{error_message}}\n• Time: {{timestamp}}"
                }
            ],
            "actions": [
                {
                    "type": "create_incident",
                    "service": "ServiceNow",
                    "priority": "P1",
                    "category": "Data Pipeline Failure"
                },
                {
                    "type": "page_oncall",
                    "service": "PagerDuty",
                    "urgency": "high"
                }
            ]
        },
        {
            "name": "Data_Quality_Below_Threshold",
            "description": "Alert when data quality metrics fall below acceptable thresholds",
            "severity": "High",
            "conditions": {
                "data_quality_score": "< 95.0",
                "completeness_rate": "< 95.0",
                "accuracy_rate": "< 98.0"
            },
            "notification_channels": [
                {
                    "type": "email",
                    "recipients": ["data-quality-team@bank.com", "data-engineering-team@bank.com"],
                    "subject": "WARNING: Data Quality Below Threshold",
                    "template": "data_quality_warning_email.html"
                },
                {
                    "type": "teams_webhook",
                    "webhook_url": "https://bank.webhook.office.com/webhookb2/...",
                    "channel": "#data-quality",
                    "message_template": "⚠️ **Data Quality Alert**\n\nQuality Score: {{quality_score}}%\nCompleteness: {{completeness}}%\nAccuracy: {{accuracy}}%\nTimestamp: {{timestamp}}"
                }
            ],
            "actions": [
                {
                    "type": "create_ticket",
                    "service": "Jira",
                    "priority": "Medium",
                    "component": "Data Quality"
                }
            ]
        },
        {
            "name": "Pipeline_Performance_Degradation",
            "description": "Alert when pipeline execution time exceeds normal thresholds",
            "severity": "Medium",
            "conditions": {
                "execution_time_minutes": "> 30",
                "databricks_job_duration_minutes": "> 20"
            },
            "notification_channels": [
                {
                    "type": "email",
                    "recipients": ["data-engineering-team@bank.com"],
                    "subject": "INFO: Pipeline Performance Degradation",
                    "template": "performance_degradation_email.html"
                },
                {
                    "type": "teams_webhook",
                    "webhook_url": "https://bank.webhook.office.com/webhookb2/...",
                    "channel": "#data-performance",
                    "message_template": "📊 **Performance Alert**\n\nPipeline: {{pipeline_name}}\nExecution Time: {{execution_time}} minutes\nExpected: {{expected_time}} minutes\nTimestamp: {{timestamp}}"
                }
            ]
        },
        {
            "name": "External_API_Failure",
            "description": "Alert when external API calls fail during data enrichment",
            "severity": "High",
            "conditions": {
                "api_failure_rate": "> 10.0",
                "consecutive_api_failures": ">= 5"
            },
            "notification_channels": [
                {
                    "type": "email",
                    "recipients": ["data-engineering-team@bank.com", "integration-team@bank.com"],
                    "subject": "WARNING: External API Failure",
                    "template": "api_failure_email.html"
                },
                {
                    "type": "teams_webhook",
                    "webhook_url": "https://bank.webhook.office.com/webhookb2/...",
                    "channel": "#api-alerts",
                    "message_template": "🔌 **API Failure Alert**\n\nAPI: {{api_name}}\nFailure Rate: {{failure_rate}}%\nError: {{error_message}}\nTimestamp: {{timestamp}}"
                }
            ],
            "actions": [
                {
                    "type": "create_ticket",
                    "service": "Jira",
                    "priority": "High",
                    "component": "External Integrations"
                }
            ]
        },
        {
            "name": "Storage_Capacity_Warning",
            "description": "Alert when storage capacity is approaching limits",
            "severity": "Medium",
            "conditions": {
                "storage_usage_percentage": "> 80.0",
                "available_space_gb": "< 100"
            },
            "notification_channels": [
                {
                    "type": "email",
                    "recipients": ["infrastructure-team@bank.com", "data-engineering-team@bank.com"],
                    "subject": "WARNING: Storage Capacity Warning",
                    "template": "storage_capacity_email.html"
                },
                {
                    "type": "teams_webhook",
                    "webhook_url": "https://bank.webhook.office.com/webhookb2/...",
                    "channel": "#infrastructure",
                    "message_template": "💾 **Storage Alert**\n\nStorage Account: {{storage_account}}\nUsage: {{usage_percentage}}%\nAvailable: {{available_space}} GB\nTimestamp: {{timestamp}}"
                }
            ]
        },
        {
            "name": "Delta_Table_Optimization_Required",
            "description": "Alert when Delta tables need optimization",
            "severity": "Low",
            "conditions": {
                "delta_table_size_gb": "> 10",
                "file_count": "> 1000",
                "last_optimization_hours": "> 24"
            },
            "notification_channels": [
                {
                    "type": "email",
                    "recipients": ["data-engineering-team@bank.com"],
                    "subject": "INFO: Delta Table Optimization Required",
                    "template": "delta_optimization_email.html"
                },
                {
                    "type": "teams_webhook",
                    "webhook_url": "https://bank.webhook.office.com/webhookb2/...",
                    "channel": "#data-optimization",
                    "message_template": "🔧 **Delta Optimization Alert**\n\nTable: {{table_name}}\nSize: {{table_size}} GB\nFiles: {{file_count}}\nLast Optimized: {{last_optimization}}\nTimestamp: {{timestamp}}"
                }
            ]
        },
        {
            "name": "Compliance_Violation_Alert",
            "description": "Alert when compliance requirements are not met",
            "severity": "Critical",
            "conditions": {
                "kyc_completion_rate": "< 100.0",
                "data_retention_violation": "true",
                "audit_trail_missing": "true"
            },
            "notification_channels": [
                {
                    "type": "email",
                    "recipients": ["compliance-team@bank.com", "legal-team@bank.com", "data-engineering-team@bank.com"],
                    "subject": "CRITICAL: Compliance Violation Detected",
                    "template": "compliance_violation_email.html"
                },
                {
                    "type": "teams_webhook",
                    "webhook_url": "https://bank.webhook.office.com/webhookb2/...",
                    "channel": "#compliance-alerts",
                    "message_template": "🚨 **COMPLIANCE VIOLATION**\n\nViolation Type: {{violation_type}}\nSeverity: {{severity}}\nDetails: {{details}}\nTimestamp: {{timestamp}}"
                }
            ],
            "actions": [
                {
                    "type": "create_incident",
                    "service": "ServiceNow",
                    "priority": "P0",
                    "category": "Compliance Violation"
                },
                {
                    "type": "page_oncall",
                    "service": "PagerDuty",
                    "urgency": "critical"
                }
            ]
        }
    ],
    "dashboards": [
        {
            "name": "Customer_Data_Pipeline_Dashboard",
            "description": "Real-time monitoring dashboard for customer data pipeline",
            "metrics": [
                {
                    "name": "Pipeline_Execution_Status",
                    "type": "status_indicator",
                    "query": "SELECT pipeline_name, status, execution_time FROM pipeline_executions WHERE execution_date >= DATE_SUB(CURRENT_DATE, 1)"
                },
                {
                    "name": "Data_Quality_Metrics",
                    "type": "gauge_chart",
                    "query": "SELECT AVG(data_quality_score) as avg_quality, AVG(completeness_rate) as avg_completeness FROM validation_results WHERE validation_date >= DATE_SUB(CURRENT_DATE, 1)"
                },
                {
                    "name": "Processing_Volume",
                    "type": "line_chart",
                    "query": "SELECT DATE(processing_time) as date, COUNT(*) as record_count FROM customer_data WHERE processing_time >= DATE_SUB(CURRENT_DATE, 7) GROUP BY DATE(processing_time)"
                },
                {
                    "name": "Error_Rate_Trend",
                    "type": "line_chart",
                    "query": "SELECT DATE(error_time) as date, COUNT(*) as error_count FROM pipeline_errors WHERE error_time >= DATE_SUB(CURRENT_DATE, 7) GROUP BY DATE(error_time)"
                }
            ],
            "refresh_interval_seconds": 300
        },
        {
            "name": "Data_Quality_Dashboard",
            "description": "Detailed data quality monitoring dashboard",
            "metrics": [
                {
                    "name": "Field_Completeness_Rates",
                    "type": "bar_chart",
                    "query": "SELECT field_name, AVG(completeness_rate) as avg_completeness FROM field_quality_metrics WHERE validation_date >= DATE_SUB(CURRENT_DATE, 1) GROUP BY field_name"
                },
                {
                    "name": "Validation_Error_Types",
                    "type": "pie_chart",
                    "query": "SELECT error_type, COUNT(*) as error_count FROM validation_errors WHERE error_date >= DATE_SUB(CURRENT_DATE, 1) GROUP BY error_type"
                },
                {
                    "name": "Quality_Score_Trend",
                    "type": "line_chart",
                    "query": "SELECT DATE(validation_time) as date, AVG(data_quality_score) as avg_score FROM validation_results WHERE validation_time >= DATE_SUB(CURRENT_DATE, 7) GROUP BY DATE(validation_time)"
                }
            ],
            "refresh_interval_seconds": 600
        }
    ],
    "notification_templates": {
        "pipeline_failure_email": {
            "subject": "CRITICAL: Customer Data Pipeline Failure",
            "body": "The customer data pipeline has failed.\n\nPipeline: {{pipeline_name}}\nExecution ID: {{execution_id}}\nError: {{error_message}}\nTimestamp: {{timestamp}}\n\nPlease investigate immediately.",
            "priority": "high"
        },
        "data_quality_warning_email": {
            "subject": "WARNING: Data Quality Below Threshold",
            "body": "Data quality metrics have fallen below acceptable thresholds.\n\nQuality Score: {{quality_score}}%\nCompleteness: {{completeness}}%\nAccuracy: {{accuracy}}%\nTimestamp: {{timestamp}}\n\nPlease review and take corrective action.",
            "priority": "medium"
        },
        "compliance_violation_email": {
            "subject": "CRITICAL: Compliance Violation Detected",
            "body": "A compliance violation has been detected in the customer data pipeline.\n\nViolation Type: {{violation_type}}\nSeverity: {{severity}}\nDetails: {{details}}\nTimestamp: {{timestamp}}\n\nImmediate action required.",
            "priority": "critical"
        }
    },
    "escalation_policies": {
        "critical_alerts": {
            "level_1": {
                "timeout_minutes": 5,
                "notify": ["oncall@bank.com"]
            },
            "level_2": {
                "timeout_minutes": 15,
                "notify": ["data-engineering-manager@bank.com", "infrastructure-manager@bank.com"]
            },
            "level_3": {
                "timeout_minutes": 30,
                "notify": ["cto@bank.com", "cio@bank.com"]
            }
        },
        "high_alerts": {
            "level_1": {
                "timeout_minutes": 15,
                "notify": ["data-engineering-team@bank.com"]
            },
            "level_2": {
                "timeout_minutes": 60,
                "notify": ["data-engineering-manager@bank.com"]
            }
        }
    }
} 